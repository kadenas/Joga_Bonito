<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#0B2C5F" />
  <title>Astillero Idle</title>
  <link rel="manifest" href="/public/manifest.webmanifest" />
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' fill='%230B2C5F'/%3E%3Cpath d='M10 65 L90 65 L80 35 L20 35 Z' fill='%23FF8C00'/%3E%3Crect x='25' y='50' width='50' height='12' fill='%23fff' opacity='0.6'/%3E%3C/svg%3E" />
  <style>
    :root {
      color-scheme: dark;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(180deg, #021327, #0B2C5F);
      color: #f5faff;
    }
    body {
      margin: 0;
      padding: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: stretch;
    }
    header, footer {
      text-align: center;
      padding: 1rem 0.5rem;
      background: rgba(5, 22, 48, 0.8);
    }
    main {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 1rem;
      padding: 1rem;
      max-width: 600px;
      width: 100%;
      margin: 0 auto;
    }
    h1 {
      margin: 0;
      font-size: 1.8rem;
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }
    .counter {
      background: rgba(2, 19, 39, 0.6);
      border-radius: 1rem;
      padding: 1rem;
      text-align: center;
    }
    .counter .total {
      font-size: 2.5rem;
      font-weight: 700;
    }
    button {
      background: #FF8C00;
      color: #011023;
      border: none;
      border-radius: 1rem;
      font-size: 1.3rem;
      padding: 1rem;
      font-weight: 700;
      box-shadow: 0 0.4rem 0 rgba(255, 140, 0, 0.4);
      transition: transform 0.1s ease, box-shadow 0.1s ease;
      touch-action: manipulation;
    }
    button:active {
      transform: translateY(0.2rem);
      box-shadow: 0 0.1rem 0 rgba(255, 140, 0, 0.4);
    }
    button[disabled] {
      opacity: 0.5;
      box-shadow: none;
      transform: none;
    }
    .primary-btn {
      font-size: 1.6rem;
    }
    .grid {
      display: grid;
      gap: 0.8rem;
    }
    .upgrades {
      display: grid;
      gap: 0.6rem;
    }
    .upgrade {
      background: rgba(2, 19, 39, 0.7);
      padding: 0.8rem;
      border-radius: 0.8rem;
      display: flex;
      flex-direction: column;
      gap: 0.4rem;
    }
    .upgrade header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      background: none;
      padding: 0;
    }
    .upgrade header h3 {
      margin: 0;
      font-size: 1.1rem;
    }
    .upgrade button {
      font-size: 1rem;
      padding: 0.6rem;
    }
    .settings {
      background: rgba(2, 19, 39, 0.6);
      border-radius: 0.8rem;
      padding: 1rem;
      display: grid;
      gap: 0.6rem;
    }
    .settings label {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 1rem;
    }
    textarea {
      width: 100%;
      min-height: 6rem;
      border-radius: 0.5rem;
      border: 1px solid rgba(255, 255, 255, 0.3);
      background: rgba(1, 17, 35, 0.9);
      color: #f5faff;
      padding: 0.5rem;
      font-family: monospace;
    }
    .modal {
      position: fixed;
      inset: 0;
      backdrop-filter: blur(4px);
      background: rgba(0, 0, 0, 0.65);
      display: none;
      align-items: center;
      justify-content: center;
      padding: 1rem;
      z-index: 10;
    }
    .modal.active {
      display: flex;
    }
    .modal-content {
      background: #031731;
      padding: 1rem;
      border-radius: 1rem;
      width: min(420px, 100%);
      display: grid;
      gap: 0.8rem;
    }
    .badge {
      font-size: 0.85rem;
      padding: 0.2rem 0.5rem;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.15);
    }
    #darsena {
      margin-top: 0.5rem;
      display: grid;
      gap: 1rem;
    }
    #darsena h2 {
      margin: 0;
      font-size: 1.3rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }
    .dock {
      background: rgba(2, 19, 39, 0.65);
      border-radius: 1rem;
      padding: 0.8rem;
      display: grid;
      gap: 0.8rem;
    }
    .lane {
      display: grid;
      gap: 0.4rem;
    }
    .lane-title {
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      opacity: 0.8;
    }
    .row {
      position: relative;
      height: 88px;
      overflow-x: auto;
      border-radius: 0.8rem;
      background: rgba(11, 44, 95, 0.25);
    }
    .row .tokens {
      position: relative;
      display: inline-flex;
      align-items: flex-end;
      padding: 0.6rem;
      min-width: 100%;
      white-space: nowrap;
    }
    .row::-webkit-scrollbar {
      height: 6px;
    }
    .row::-webkit-scrollbar-thumb {
      background: rgba(230, 241, 255, 0.2);
      border-radius: 3px;
    }
    .water {
      position: absolute;
      inset: 0;
      background: linear-gradient(180deg, rgba(230, 241, 255, 0.15), rgba(11, 44, 95, 0.25));
      mask: url(#waveMask) repeat-x;
      mask-size: 256px 100%;
      -webkit-mask: url(#waveMask) repeat-x;
      -webkit-mask-size: 256px 100%;
      animation: waterShift 12s linear infinite;
      opacity: 0.18;
      pointer-events: none;
    }
    .token {
      display: inline-flex;
      width: 64px;
      height: 64px;
      margin-right: 0.6rem;
      justify-content: center;
      align-items: center;
      transform-origin: 50% 50%;
    }
    .token:last-child {
      margin-right: 0;
    }
    .token svg {
      width: 64px;
      height: 64px;
    }
    .token.ship {
      animation: bob 3.2s ease-in-out infinite;
    }
    .token.worker {
      animation: bob 2.4s ease-in-out infinite;
    }
    .token.crane {
      animation: tilt 5s ease-in-out infinite;
    }
    #summary {
      background: rgba(2, 19, 39, 0.65);
      border-radius: 1rem;
      padding: 0.8rem;
      display: grid;
      gap: 0.6rem;
    }
    #summary h3 {
      margin: 0;
      font-size: 1rem;
      letter-spacing: 0.05em;
      text-transform: uppercase;
    }
    .summary-grid {
      display: flex;
      gap: 0.6rem;
      flex-wrap: wrap;
    }
    .summary-badge {
      background: rgba(230, 241, 255, 0.1);
      border-radius: 0.8rem;
      padding: 0.6rem 0.8rem;
      display: grid;
      gap: 0.2rem;
      min-width: 92px;
    }
    .summary-badge .label {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      opacity: 0.7;
    }
    .summary-badge .value {
      font-size: 1.3rem;
      font-weight: 600;
    }
    @keyframes bob {
      0% {
        transform: translateY(0) rotate(0deg);
      }
      50% {
        transform: translateY(-3px) rotate(-0.3deg);
      }
      100% {
        transform: translateY(0) rotate(0deg);
      }
    }
    @keyframes tilt {
      0%,
      100% {
        transform: rotate(0deg);
      }
      50% {
        transform: rotate(1deg);
      }
    }
    @keyframes waterShift {
      from {
        background-position-x: 0;
      }
      to {
        background-position-x: -256px;
      }
    }
    @media (min-width: 720px) {
      #darsena {
        grid-template-columns: minmax(0, 1fr) minmax(180px, 220px);
        align-items: start;
      }
      #summary {
        position: sticky;
        top: 1rem;
        height: fit-content;
      }
    }
  </style>
</head>
<body>
  <svg id="sprite-defs" width="0" height="0" aria-hidden="true" focusable="false">
    <defs>
      <symbol id="ship-hull" viewBox="0 0 64 64">
        <path d="M6 36h52l-5 14c-1.5 4.2-5.5 7-10 7H21c-4.5 0-8.5-2.8-10-7L6 36z" fill="#FF8C00" />
        <path d="M12 42h40l-2 6H14l-2-6z" fill="#0B2C5F" />
        <path d="M20 46h24" stroke="#E6F1FF" stroke-width="2" stroke-linecap="round" opacity="0.8" />
      </symbol>
      <symbol id="ship-cabin" viewBox="0 0 64 64">
        <rect x="18" y="18" width="28" height="16" rx="4" fill="#E6F1FF" />
        <rect x="22" y="22" width="6" height="6" rx="1" fill="#0B2C5F" opacity="0.8" />
        <rect x="36" y="22" width="6" height="6" rx="1" fill="#0B2C5F" opacity="0.8" />
      </symbol>
      <symbol id="ship-mast" viewBox="0 0 64 64">
        <rect x="30" y="8" width="4" height="24" rx="2" fill="#E6F1FF" opacity="0.9" />
        <path d="M32 10l12 12-12 6z" fill="#0B2C5F" opacity="0.85" />
      </symbol>
      <symbol id="crane" viewBox="0 0 64 64">
        <rect x="10" y="44" width="16" height="10" rx="2" fill="#0B2C5F" />
        <rect x="14" y="20" width="8" height="24" rx="3" fill="#FF8C00" />
        <path d="M18 20l26-10 2 6-18 6v22" fill="none" stroke="#E6F1FF" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" />
        <path d="M40 16l10 8" stroke="#0B2C5F" stroke-width="3" stroke-linecap="round" />
        <path d="M46 30v8" stroke="#0B2C5F" stroke-width="3" stroke-linecap="round" />
        <path d="M46 40c0 2.2-1.8 4-4 4s-4-1.8-4-4" fill="none" stroke="#FF8C00" stroke-width="2" />
      </symbol>
      <symbol id="worker" viewBox="0 0 64 64">
        <circle cx="32" cy="18" r="8" fill="#E6F1FF" />
        <rect x="24" y="12" width="16" height="6" rx="3" fill="#FF8C00" />
        <rect x="22" y="28" width="20" height="22" rx="6" fill="#0B2C5F" />
        <rect x="18" y="30" width="6" height="16" rx="3" fill="#FF8C00" />
        <rect x="40" y="30" width="6" height="16" rx="3" fill="#FF8C00" />
        <path d="M18 30l-6-4" stroke="#E6F1FF" stroke-width="3" stroke-linecap="round" />
        <path d="M44 30l8-4" stroke="#E6F1FF" stroke-width="3" stroke-linecap="round" />
      </symbol>
      <symbol id="wave" viewBox="0 0 64 16">
        <path d="M0 8c4 0 6-4 10-4s6 4 10 4 6-4 10-4 6 4 10 4 6-4 10-4 6 4 10 4v8H0z" fill="#fff" />
      </symbol>
      <pattern id="wavePattern" patternUnits="userSpaceOnUse" width="64" height="16">
        <use href="#wave" />
      </pattern>
      <mask id="waveMask">
        <rect width="100%" height="100%" fill="url(#wavePattern)" />
      </mask>
    </defs>
  </svg>
  <header>
    <h1>Astillero Idle</h1>
  </header>
  <main>
    <section class="counter" aria-live="polite">
      <div class="total" id="jornalesDisplay">0</div>
      <div id="jpsDisplay">0 Jornales/s</div>
      <div class="badge" id="bonusStatus">Marea viva lista</div>
    </section>
    <div class="grid">
      <button id="tapButton" class="primary-btn">Remachar casco</button>
      <button id="bonusButton">Marea viva</button>
    </div>
    <section id="darsena" aria-labelledby="darsena-title">
      <h2 id="darsena-title">Dársena</h2>
      <div class="dock">
        <div class="lane" data-lane="barcos">
          <span class="lane-title">Barcos en reparación</span>
          <div class="row" data-row="barcos">
            <div class="water" aria-hidden="true"></div>
            <div class="tokens" role="list" aria-live="polite" aria-label="Barcos en reparación"></div>
          </div>
        </div>
        <div class="lane" data-lane="obreros">
          <span class="lane-title">Aprendices</span>
          <div class="row" data-row="obreros">
            <div class="water" aria-hidden="true"></div>
            <div class="tokens" role="list" aria-live="polite" aria-label="Aprendices"></div>
          </div>
        </div>
        <div class="lane" data-lane="gruas">
          <span class="lane-title">Grúas y equipo</span>
          <div class="row" data-row="gruas">
            <div class="water" aria-hidden="true"></div>
            <div class="tokens" role="list" aria-live="polite" aria-label="Grúas y equipo"></div>
          </div>
        </div>
      </div>
      <aside id="summary" aria-labelledby="summary-title">
        <h3 id="summary-title">Resumen del astillero</h3>
        <div class="summary-grid">
          <div class="summary-badge" data-summary="barcos">
            <span class="label">Barcos</span>
            <span class="value">0</span>
          </div>
          <div class="summary-badge" data-summary="obreros">
            <span class="label">Obreros</span>
            <span class="value">0</span>
          </div>
          <div class="summary-badge" data-summary="gruas">
            <span class="label">Grúas</span>
            <span class="value">0</span>
          </div>
        </div>
      </aside>
    </section>
    <section class="upgrades" id="upgradesList" aria-label="Mejoras disponibles"></section>
    <section class="settings">
      <h2>Ajustes</h2>
      <label>
        Audio
        <input type="checkbox" id="audioToggle" checked />
      </label>
      <label>
        Vibración
        <input type="checkbox" id="vibrationToggle" checked />
      </label>
      <div class="grid">
        <button id="exportButton">Exportar progreso</button>
        <button id="importButton">Importar progreso</button>
      </div>
    </section>
  </main>
  <footer>
    Versión 0.1.0 — Mantén el astillero en marcha
  </footer>
  <div class="modal" id="modal">
    <div class="modal-content">
      <h3 id="modalTitle">Exportar</h3>
      <textarea id="modalTextarea" readonly></textarea>
      <div class="grid">
        <button id="modalCopy">Copiar</button>
        <button id="modalClose">Cerrar</button>
      </div>
    </div>
  </div>
  <script type="module" src="/src/main.js"></script>
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js').catch(console.error);
      });
    }
  </script>
</body>
</html>
